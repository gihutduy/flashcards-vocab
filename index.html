
<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flashcards — Học từ vựng</title>

  <!-- Tailwind CDN (quick, for demo) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React & ReactDOM (production) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel for JSX (acceptable for small static demo) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    /* small helper for card flip */
    .card-face {
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      transition: transform 0.4s;
    }
    .card-front { transform: rotateY(0deg); }
    .card-back  { transform: rotateY(180deg); position: absolute; left:0; top:0; width:100%; height:100%; }
    .flipped .card-front { transform: rotateY(-180deg); }
    .flipped .card-back  { transform: rotateY(0deg); }
  </style>
</head>
<body class="bg-sky-50 min-h-screen flex items-center justify-center p-4">
  <div id="root" class="w-full max-w-2xl"></div>

  <script type="text/babel">

  const { useState, useEffect, useRef } = React;

  /************* DATA *************/
  const WORDS = [
    {word: "beginning", ipa: "/bɪˈɡɪnɪŋ/", pos: "n", vn: "sự bắt đầu"},
    {word: "sit", ipa: "/sɪt/", pos: "v", vn: "ngồi"},
    {word: "soup", ipa: "/suːp/", pos: "n", vn: "súp"},
    {word: "salt", ipa: "/sɔːlt/", pos: "n", vn: "muối"},
    {word: "seal", ipa: "/siːl/", pos: "n/v", vn: "hải cẩu; niêm phong"},
    {word: "sick", ipa: "/sɪk/", pos: "adj", vn: "ốm, bệnh"},
    {word: "sing", ipa: "/sɪŋ/", pos: "v", vn: "hát"},
    {word: "sun", ipa: "/sʌn/", pos: "n", vn: "mặt trời"},
    {word: "save", ipa: "/seɪv/", pos: "v", vn: "lưu, cứu"},
    {word: "seed", ipa: "/siːd/", pos: "n", vn: "hạt giống"},
    {word: "seat", ipa: "/siːt/", pos: "n", vn: "ghế, chỗ ngồi"},
    {word: "city", ipa: "/ˈsɪti/", pos: "n", vn: "thành phố"},
    {word: "said", ipa: "/sed/", pos: "v", vn: "đã nói"},
    {word: "sad", ipa: "/sæd/", pos: "adj", vn: "buồn"},
    {word: "sorry", ipa: "/ˈsɒri/", pos: "adj", vn: "xin lỗi, tiếc"},
    {word: "soap", ipa: "/səʊp/", pos: "n", vn: "xà phòng"},
    {word: "sock", ipa: "/sɒk/", pos: "n", vn: "tất, vớ"},
    {word: "sail", ipa: "/seɪl/", pos: "v/n", vn: "đi thuyền; cánh buồm"},
    {word: "sour", ipa: "/ˈsaʊər/", pos: "adj", vn: "chua"},
    {word: "sign", ipa: "/saɪn/", pos: "n/v", vn: "dấu hiệu; ký tên"},
    {word: "sand", ipa: "/sænd/", pos: "n", vn: "cát"},
    {word: "soft", ipa: "/sɒft/", pos: "adj", vn: "mềm"},
    {word: "seven", ipa: "/ˈsevən/", pos: "num", vn: "bảy"},
    {word: "sink", ipa: "/sɪŋk/", pos: "v/n", vn: "chìm; bồn rửa"},
    {word: "son", ipa: "/sʌn/", pos: "n", vn: "con trai"},
    {word: "safe", ipa: "/seɪf/", pos: "adj", vn: "an toàn"},
    {word: "baseball", ipa: "/ˈbeɪsbɔːl/", pos: "n", vn: "bóng chày"},
    {word: "dancer", ipa: "/ˈdænsər/", pos: "n", vn: "vũ công"},
    {word: "pencil", ipa: "/ˈpensəl/", pos: "n", vn: "bút chì"},
    {word: "fossil", ipa: "/ˈfɒsəl/", pos: "n", vn: "hoá thạch"},
    {word: "listen", ipa: "/ˈlɪsən/", pos: "v", vn: "lắng nghe"},
    {word: "bus", ipa: "/bʌs/", pos: "n", vn: "xe buýt"},
    {word: "face", ipa: "/feɪs/", pos: "n", vn: "khuôn mặt"},
    {word: "house", ipa: "/haʊs/", pos: "n", vn: "ngôi nhà"},
    {word: "mouse", ipa: "/maʊs/", pos: "n", vn: "con chuột"},
    {word: "juice", ipa: "/dʒuːs/", pos: "n", vn: "nước ép"},
    {word: "scoop", ipa: "/skuːp/", pos: "n/v", vn: "muỗng; múc"},
    {word: "scarf", ipa: "/skɑːrf/", pos: "n", vn: "khăn quàng"},
    {word: "slow", ipa: "/sləʊ/", pos: "adj", vn: "chậm"},
    {word: "smile", ipa: "/smaɪl/", pos: "v/n", vn: "cười"},
    {word: "snail", ipa: "/sneɪl/", pos: "n", vn: "con ốc sên"},
    {word: "spoon", ipa: "/spuːn/", pos: "n", vn: "cái muỗng"},
    {word: "stamp", ipa: "/stæmp/", pos: "n/v", vn: "con tem; đóng dấu"},
    {word: "sweep", ipa: "/swiːp/", pos: "v", vn: "quét"},
    {word: "swim", ipa: "/swɪm/", pos: "v", vn: "bơi"},
  ];

  const STORAGE_KEY = "flashcards_v1";

  function loadProgress() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : {};
    } catch (e) {
      return {};
    }
  }
  function saveProgress(obj) {
    try {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));
    } catch (e) { }
  }

  function App() {
    const [cards, setCards] = React.useState(WORDS.map((w,i)=>({...w,id:i})));
    const [idx, setIdx] = React.useState(0);
    const [flipped, setFlipped] = React.useState(false);
    const [progress, setProgress] = React.useState(loadProgress());
    const fileRef = React.useRef(null);

    React.useEffect(()=> saveProgress(progress), [progress]);

    function next() {
      setFlipped(false);
      setIdx(i => (i+1) % cards.length);
    }
    function prev() {
      setFlipped(false);
      setIdx(i => (i-1 + cards.length) % cards.length);
    }
    function shuffle() {
      const arr = [...cards];
      for (let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
      }
      setCards(arr);
      setIdx(0);
    }
    function mark(id, status) {
      const now = new Date().toISOString();
      const p = {...progress, [id]: {status, last: now}};
      setProgress(p);
    }
    function speak(text){
      if(!window.speechSynthesis) return;
      const u = new SpeechSynthesisUtterance(text);
      u.lang = "en-US";
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(u);
    }
    function exportJSON(){
      const payload = {cards, progress};
      const blob = new Blob([JSON.stringify(payload, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "flashcards_export.json"; a.click();
      URL.revokeObjectURL(url);
    }
    function importJSON(e){
      const file = e.target.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = ev => {
        try{
          const parsed = JSON.parse(ev.target.result);
          if(parsed.cards) {
            const withId = parsed.cards.map((c,i)=>({...c, id:c.id ?? i}));
            setCards(withId);
          }
          if(parsed.progress) setProgress(parsed.progress);
          alert("Imported!");
        } catch(err){
          alert("File không hợp lệ.");
        }
      };
      reader.readAsText(file);
      e.target.value = "";
    }

    const card = cards[idx] || {word:"—", ipa:"", vn:""};
    const knownCount = Object.values(progress).filter(p=>p.status==="known").length;
    const againCount = Object.values(progress).filter(p=>p.status==="again").length;

    return (
      <div className="bg-white rounded-2xl shadow-lg p-6 w-full">
        <header className="flex items-center justify-between mb-4">
          <h1 className="text-xl font-bold">Flashcards — Học từ vựng</h1>
          <div className="text-sm">{idx+1}/{cards.length}</div>
        </header>

        <main className="flex flex-col md:flex-row gap-4">
          <section className="flex-1">
            <div className={`relative w-full h-52 md:h-64 perspective`}>
              <div className={`relative w-full h-full bg-slate-50 rounded-xl p-6 flex flex-col items-center justify-center transform transition-transform duration-500 ${flipped ? "flipped":""}`}>
                <div className="card-face card-front text-center">
                  <div className="text-3xl font-semibold mb-2">{card.word}</div>
                  <div className="text-lg italic mb-2">{card.ipa}</div>
                  <div className="text-sm text-gray-500">Chạm Flip để xem nghĩa</div>
                </div>
                <div className="card-face card-back text-center">
                  <div className="text-2xl font-medium mb-1">{card.word}</div>
                  <div className="italic mb-2">{card.ipa}</div>
                  <div className="text-base text-gray-700">{card.vn}</div>
                  <div className="text-xs text-gray-500 mt-1">{card.pos}</div>
                </div>
              </div>
            </div>

            <div className="mt-4 flex gap-2 justify-center">
              <button className="px-4 py-2 bg-blue-600 text-white rounded" onClick={()=>speak(card.word)}>Speak</button>
              <button className="px-4 py-2 bg-gray-200 rounded" onClick={()=>setFlipped(f=>!f)}>Flip</button>
              <button className="px-4 py-2 bg-white rounded shadow" onClick={prev}>Prev</button>
              <button className="px-4 py-2 bg-white rounded shadow" onClick={next}>Next</button>
            </div>

            <div className="mt-4 flex gap-2 justify-center">
              <button className="px-3 py-2 bg-red-500 text-white rounded" onClick={()=>{mark(card.id,"again"); next();}}>Again</button>
              <button className="px-3 py-2 bg-green-600 text-white rounded" onClick={()=>{mark(card.id,"known"); next();}}>Known</button>
            </div>
          </section>

          <aside className="w-full md:w-64">
            <div className="bg-sky-50 p-3 rounded">
              <div className="font-medium mb-2">Tools</div>
              <div className="flex flex-col gap-2">
                <button className="px-3 py-2 bg-white rounded shadow text-left" onClick={shuffle}>Shuffle cards</button>
                <button className="px-3 py-2 bg-white rounded shadow text-left" onClick={()=>{setCards(WORDS.map((w,i)=>({...w,id:i}))); setIdx(0); setProgress({});}}>Reset deck</button>
                <button className="px-3 py-2 bg-white rounded shadow text-left" onClick={exportJSON}>Export JSON</button>
                <label className="px-3 py-2 bg-white rounded shadow cursor-pointer text-left">
                  Import JSON
                  <input type="file" accept="application/json" onChange={importJSON} ref={fileRef} className="hidden" />
                </label>
              </div>

              <div className="mt-3 text-sm">
                <div>Known: <strong>{knownCount}</strong></div>
                <div>Again: <strong>{againCount}</strong></div>
                <div className="mt-2 text-xs text-gray-500">Progress lưu cục bộ (localStorage).</div>
              </div>

              <div className="mt-3 text-xs text-gray-500">Bạn có thể mở rộng: thêm ví dụ câu, SRS, đồng bộ hoá với GitHub/GDrive.</div>
            </div>
          </aside>
        </main>

        <footer className="mt-4 text-center text-xs text-gray-600">
          <div>Static site — host dễ dàng bằng GitHub Pages.</div>
        </footer>
      </div>
    );
  }

  ReactDOM.createRoot(document.getElementById("root")).render(<div className="p-4"><App /></div>);

  </script>
</body>
</html>
